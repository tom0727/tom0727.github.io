+++
title = 'FFT'
date = 2021-09-17T13:52:57+08:00
draft = false
categories = ['算法']
tags = ['fft']
+++

## 介绍

FFT (Fast Fourier Transform, 快速傅立叶变换) 可以在 $O(n\logn)$ 的时间内计算两个多项式的乘法。

在开始介绍 FFT 之前，我们需要一些基本的前置知识。

## 多项式

一个多项式有两种表示方法：**系数表示法** 和 **点值表示法**。

### 系数表示法

$$f(x) = a_0 + a_1x + a_2x^2 + ... + a_nx^n$$

则 $\\{a_0,a_1,...,a_n\\}$ 即可表示这个多项式 $f(x)$。

### 点值表示法

选取多项式函数上的 $(n+1)$ 个点 $(x_0,y_0), (x_1,y_1), ..., (x_n,y_n)$ 也可以唯一的表示这个多项式 $f(x)$。

证明：使用高斯消元即可，$(n+1)$ 个未知量，对应 $(n+1)$ 个方程。

## 复数

### $n$ 次单位根

若 $\omega$ 满足 $\omega^n = 1$，那么 $\omega$ 就是 $n$ 次单位根 (n-th root of unity)。

若 $\omega$ 满足 $\omega^n = 1$，**且满足** $\omega ^ k \neq 1, \forall k \in [1, n-1]$，则 $\omega$ 就是 $n$ 次**本原**单位根 (primitive n-th root of unity)

### $\omega$ 的取值

{{% warning 问题 %}}

给定两个已知多项式 $f(x)$ 和 $g(x)$，$deg(f) = n_1, deg(g) = n_2$，求 $h(x) = f(x) * g(x)$？

{{% /warning %}}




## FFT原理

{{% question 问题 %}}

给定两个已知多项式 $f(x)$ 和 $g(x)$，$deg(f) = n_1, deg(g) = n_2$，求 $h(x) = f(x) * g(x)$？

{{% /question %}}

FFT 分为三步：

1. **DFT**：令 $n = n_1 + n_2$，在 $x$ 轴上选择 $(n + 1)$ 个**特殊点** $x_0,x_1,...,x_{n}$，求出 $f(x_0), f(x_1), ..., f(x_n)$ 与 $g(x_0), g(x_1), ..., g(x_n)$ 的值。

    复杂度：$O(n\log n)$
   
2. **点值乘法**：求出 $(n+1)$ 个点上，点值的乘积，即 $h(x_i) = f(x_i) * g(x_i), i \in [0, n]$

    复杂度：$O(n)$


3. **IDFT**：给定一个未知 $h(x)$ 上的 $(n+1)$ 个**特殊点** $\\{(x_0,y_0), (x_1,y_1), ..., (x_n,y_n)\\}$，求出 $h(x)$ 的系数表达式。

    复杂度：$O(n\log n)$




